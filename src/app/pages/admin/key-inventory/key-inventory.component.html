<section class="position-relative py-4 py-xl-5">
  <div class="container position-relative">
    <div class="row d-flex justify-content-center">
      <div class="col-12">
        <div class="card shadow">
          <div class="card-header py-2 d-flex justify-content-between">
            <p class="lead m-0"><strong>Key Inventory</strong></p>
          </div>
          <div class="card-body">
            <div class="table-responsive table mb-0 pt-3 pr-2">
              <table class="table table-striped table-sm my-0 mydatatable">
                <thead>
                  <tr class="text-nowrap">
                    <th>Room Name</th>
                    <th>Keys</th>
                    <th>Room Details</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngIf="!keys.length">
                    <br />
                    No key found.
                    <br />
                    <br />
                  </tr>
                  <tr
                    class="text-nowrap"
                    *ngFor="let key of keys; let i = index"
                  >
                    <td>{{ key.room_name }}</td>
                    <td>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="50"
                        height="50"
                        viewBox="0 0 128 128"
                        *ngIf="key.room_status == 'available'"
                      >
                        <path
                          fill="#9E740B"
                          d="M107.77 15.16c-14.5-11.48-35.93-6.24-46.72 3.2c-12.08 10.56-12.42 27.25-6.13 40.88l-43.58 42.77c-1.77 1.74-3.59 14.19-3.5 16.64l5.9 4.12s9.99 2.99 14.34-.41s8.17-9.56 7.72-12.33c-.26-1.59.08-3.07 1.11-4.08c1.28-1.26 3.32-1.47 5.39-.78c1.59.53 3.36.08 4.55-1.09l.42-.41c1.69-1.58 1.88-3.42 1.55-4.96c-.51-2.39.36-4.37 1.7-6.12c1.16-1.52 3.36-2.16 5.28-2.19c3.46-.05 5.7-.79 8.15-3.19l6.38-6.24c14.36 6.4 31.97 3.51 43.4-8.68c14.66-15.64 10.91-43.77-5.96-57.13zm-8.64 33.35c-4 3.92-10.48 3.92-14.48 0s-4-10.29 0-14.21c4-3.92 10.48-3.92 14.48 0s4 10.29 0 14.21z"
                        />
                        <path
                          fill="#FFCA28"
                          d="M107.77 15.16c-14.88-14.88-39-14.88-53.88 0c-11.39 11.39-14.05 28.18-8.01 42.11L7.83 95.08a9.11 9.11 0 0 0-2.67 6.76l.44 11.75c2.17 1.22 2.24 5.07 2.24 5.07l9.9.76c2.53.08 4.98-.89 6.76-2.67l3.14-3.14c1.96-1.96 3.07-4.73 2.58-7.45c-.31-1.69.03-3.27 1.1-4.34c1.26-1.26 3.23-1.5 5.26-.87c1.69.53 3.53.19 4.79-1.06l.43-.43c1.71-1.63 1.9-3.52 1.57-5.1c-.51-2.46.37-4.49 1.71-6.29c1.17-1.57 3.4-2.22 5.33-2.25c3.49-.05 5.76-.81 8.23-3.28l5.98-5.95c14.13 6.65 31.49 4.14 43.17-7.54c14.86-14.89 14.86-39.01-.02-53.89zm-13.6 28.22c-4.04 4.04-10.59 4.04-14.62 0c-4.04-4.04-4.04-10.59 0-14.62c4.04-4.04 10.59-4.04 14.62 0c4.04 4.03 4.04 10.58 0 14.62z"
                        />
                        <path
                          fill="#DBA010"
                          d="M5.6 113.59s1.24.84 2.24 5.07l47.48-48.27c1.55-1.7-5.4-.82-7.48 1.25L5.6 113.59z"
                        />
                        <path
                          fill="#FFF59D"
                          d="M60.43 19.92c-3.9 2.12-8.3 7.8-9.51 16c-1.1 7.44-.63 12.61 1.87 16.96c2.83 4.91 6.68 2.31 5.13-2.47c-1.02-3.15-1.28-4.34-1.42-7.68c-.11-2.61.16-5.24.9-7.74c1.84-6.2 6.11-10.27 7.36-12.28c1.59-2.57-.92-4.66-4.33-2.79zm-27.38 59.8c-2.84 2.42.1-5.11 2.28-7.65C38.2 68.71 45 61.58 46.2 60.97c1.64-.83 1.54 3.75.87 4.59C44.69 68.5 35.9 77.3 33.05 79.72z"
                        />
                      </svg>
                    </td>
                    <td>
                      <div>
                        <a
                          class="btn btn-primary"
                          role="button"
                          (click)="
                            handleButtonClick(
                              key.room_id,
                              key.semester_id,
                              key.room_status
                            )
                          "
                          href="#myModal{{ key.room_id }}"
                          data-bs-toggle="modal"
                          >See Details</a
                        >
                        <div
                          id="myModal{{ key.room_id }}"
                          class="modal fade"
                          role="dialog"
                          tabindex="-1"
                        >
                          <div
                            class="modal-dialog modal-dialog-centered"
                            role="document"
                          >
                            <div class="modal-content">
                              <div class="modal-header">
                                <h4>Room Details</h4>
                                <button
                                  class="btn-close"
                                  type="button"
                                  data-bs-dismiss="modal"
                                  aria-label="Close"
                                ></button>
                              </div>
                              <div class="modal-body">
                                <form
                                  method="post"
                                  #ngForm="ngForm"
                                  (ngSubmit)="submitRegFaculty()"
                                >
                                  <div class="p-5">
                                    <div class="mb-3">
                                      <label for="email">Room Name</label
                                      ><input
                                        class="form-control"
                                        type="text"
                                        readonly
                                        disabled
                                        value="{{ key.room_name }}"
                                      />
                                    </div>
                                    <div
                                      class="mb-3"
                                      *ngIf="key.room_status == 'available'"
                                    >
                                      <label for=""
                                        >Current Scheduled Faculty</label
                                      >
                                      <select
                                        class="form-select"
                                        [(ngModel)]="form.user_id"
                                        name="user_id"
                                      >
                                        <option
                                          [ngValue]="null"
                                          selected
                                          disabled
                                        >
                                          Select Faculty
                                        </option>
                                        <option
                                          *ngFor="let user of users"
                                          [value]="user.value"
                                        >
                                          {{ user.label }}
                                        </option>
                                      </select>
                                    </div>
                                    <div
                                      class="mb-3"
                                      *ngIf="key.room_status == 'borrowed'"
                                    >
                                      <label for="email"
                                        >Current Scheduled Faculty</label
                                      ><input
                                        class="form-control"
                                        type="text"
                                        name="name"
                                        readonly
                                        disabled
                                        [value]="faculty_name"
                                      />
                                    </div>
                                    <div class="mb-3">
                                      <label for="email">Time</label
                                      ><input
                                        class="form-control"
                                        type="text"
                                        name="middleName"
                                        required
                                        readonly
                                        disabled
                                        value="Auto Generated"
                                      />
                                    </div>
                                    <div
                                      class="mb-3 d-flex justify-content-center"
                                    >
                                      <button
                                        class="btn btn-success"
                                        type="submit"
                                        *ngIf="key.room_status == 'available'"
                                      >
                                        Lent Key
                                      </button>
                                      <button
                                        class="btn btn-danger"
                                        type="submit"
                                        *ngIf="key.room_status == 'borrowed'"
                                      >
                                        Return Key
                                      </button>
                                    </div>
                                  </div>
                                </form>
                              </div>
                              <div class="modal-footer"></div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
